{"version":3,"sources":["webpack:///./src/utils/useSorter.tsx","webpack:///./src/components/TunesByProgram.tsx","webpack:///./src/templates/artist.tsx"],"names":["useSorter","sort","useAppState","React","value","useSortProgram","sorter","a","b","week","useSortProgramNode","node","useStyles","makeStyles","theme","createStyles","root","padding","spacing","header","title","fontWeight","typography","fontWeightBold","TunesByProgramSkeleton","classes","className","variant","color","width","Array","from","length","map","_","index","key","TunesByProgram","program","date","to","fields","slug","playlist","tune","id","BindKeyboardSwipeableViews","bindKeyboard","SwipeableViews","ArtistTemplate","data","pageContext","previous","next","sortProgram","initialIndex","programs","artist","tunes","filter","tabs","TonarinoTab","name","item","indicatorColor","centered","label","artists","relatedArtists","element","Boolean","drawerContents","onChangeIndex","navigate","resistance"],"mappings":"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","file":"component---src-templates-artist-tsx-9d692c30c5c7a7b7ca38.js","sourcesContent":["import * as React from 'react';\nimport { useAppState } from '../gatsby-theme-aoi-top-layout/utils/AppStateContext';\nimport { Maybe, Program, ProgramPlaylist } from '../../graphql-types';\n\n/** usage\n * const sorter = useSorter();\n * programs.sort((a, b) => sorter(a.week - b.week))\n */\nexport default function useSorter() {\n  const { sort } = useAppState();\n  return React.useCallback((value: number) => (sort === 'older' ? value : -value), [sort]);\n}\n\nexport function useSortProgram() {\n  const sorter = useSorter();\n  return (a: Maybe<Pick<Program, 'week'>> | undefined, b: Maybe<Pick<Program, 'week'>> | undefined) =>\n    sorter((a?.week ?? 0) - (b?.week ?? 0));\n}\n\nexport function useSortProgramNode() {\n  const sorter = useSorter();\n  return (a: { node: Maybe<Pick<Program, 'week'>> }, b: { node: Maybe<Pick<Program, 'week'>> }) =>\n    sorter((a?.node?.week ?? 0) - (b?.node?.week ?? 0));\n}\n\nexport function useSortPlaylist() {\n  const sorter = useSorter();\n  return (\n    a: Maybe<Pick<ProgramPlaylist, 'week' | 'indexInWeek'>> | undefined,\n    b: Maybe<Pick<ProgramPlaylist, 'week' | 'indexInWeek'>> | undefined\n  ) => sorter((a?.week ?? 0) - (b?.week ?? 0) || (a?.indexInWeek ?? 0) - (b?.indexInWeek ?? 0));\n}\n","import * as React from 'react';\nimport Typography from '@material-ui/core/Typography';\nimport { makeStyles, createStyles } from '@material-ui/core/styles';\nimport Skeleton from '@material-ui/lab/Skeleton';\nimport AppLink from 'gatsby-theme-aoi/src/components/AppLink';\nimport Tune, { TuneSkeleton, TuneProps } from './Tune';\nimport TextSpan from './TextSpan';\nimport { Maybe, Program } from '../../graphql-types';\n\nconst useStyles = makeStyles((theme) =>\n  createStyles({\n    root: {\n      padding: theme.spacing(1, 0),\n    },\n    header: {\n      padding: theme.spacing(1),\n    },\n    title: {\n      fontWeight: theme.typography.fontWeightBold,\n    },\n  })\n);\n\nexport interface TunesByProgramProps {\n  program: Maybe<\n    Pick<Program, 'id' | 'week' | 'date' | 'fields' | 'title'> & {\n      playlist: TuneProps['tune'][];\n    }\n  >;\n}\n\nfunction TunesByProgram({ program }: TunesByProgramProps) {\n  const classes = useStyles();\n  return (\n    <div className={classes.root}>\n      <div className={classes.header}>\n        <Typography variant=\"body2\" color=\"textSecondary\">\n          <TextSpan>第{program?.week}回</TextSpan>\n          <TextSpan>{program?.date}</TextSpan>\n        </Typography>\n        <Typography className={classes.title} variant=\"body1\">\n          <AppLink to={program?.fields?.slug ?? '#'}>{program?.title}</AppLink>\n        </Typography>\n      </div>\n      <div>{program?.playlist?.map((tune) => <Tune key={tune?.id} tune={tune} />) ?? null}</div>\n    </div>\n  );\n}\n\nexport default TunesByProgram;\n\nexport function TunesByProgramSkeleton() {\n  const classes = useStyles();\n  return (\n    <div className={classes.root}>\n      <div className={classes.header}>\n        <Typography variant=\"body2\" color=\"textSecondary\">\n          <TextSpan>\n            <Skeleton width={40} />\n          </TextSpan>\n          <TextSpan>\n            <Skeleton width={60} />\n          </TextSpan>\n        </Typography>\n        <Typography className={classes.title} variant=\"body1\" color=\"secondary\">\n          <Skeleton width={260} />\n        </Typography>\n      </div>\n      <div>{Array.from({ length: 4 }).map((_, index) => <TuneSkeleton key={index} />) ?? null}</div>\n    </div>\n  );\n}\n","import * as React from 'react';\nimport { graphql, navigate } from 'gatsby';\nimport Tabs from '@material-ui/core/Tabs';\nimport Tab from '@material-ui/core/Tab';\nimport SwipeableViews from 'react-swipeable-views';\nimport { bindKeyboard } from 'react-swipeable-views-utils';\nimport Layout from '../layout/';\nimport Section, { SectionDivider } from '../components/Section';\nimport { ArtistPageHeader } from '../components/PageHeader';\nimport TunesByProgram, { TunesByProgramSkeleton } from '../components/TunesByProgram';\nimport ArtistItemContainer from '../components/ArtistItemContainer';\nimport PageNavigation from '../components/PageNavigation';\nimport DrawerNavigation from '../components/DrawerNavigation';\nimport NavigationBox from '../components/NavigationBox';\nimport { AdInArticle } from '../components/Ads';\nimport { useSortProgram } from '../utils/useSorter';\nimport { ArtistTemplateQuery, SitePageContext, SitePageContextPrevious, SitePageContextNext } from '../../graphql-types';\n\nconst BindKeyboardSwipeableViews = bindKeyboard(SwipeableViews);\n\ninterface Props {\n  data: ArtistTemplateQuery;\n  pageContext: SitePageContext;\n}\n\nfunction ArtistTemplate({ data, pageContext }: Props) {\n  const { previous, next } = pageContext;\n  const sortProgram = useSortProgram();\n  const initialIndex = previous ? 1 : 0;\n  const handleChangeIndex = (index: number) => {\n    if (index === initialIndex) return;\n    if (next && index === initialIndex + 1) {\n      navigate(`/artist/${next.name}`);\n    }\n    if (previous && index === initialIndex - 1) {\n      navigate(`/artist/${previous?.name}`);\n    }\n  };\n  const programs = data.artist?.program?.map((program) => ({\n    ...program,\n    playlist: data.artist?.tunes?.filter((tune) => tune?.week === program?.week),\n  }));\n  const tabs = [\n    previous ? <TonarinoTab key={previous?.name} item={previous} /> : null,\n    <div key=\"main\">\n      <ArtistPageHeader artist={data.artist} />\n      <SectionDivider />\n      <Section>\n        <Tabs indicatorColor=\"secondary\" centered value={0}>\n          <Tab label=\"曲\" />\n          <Tab label=\"詳細\" />\n        </Tabs>\n        <div>\n          {programs?.sort(sortProgram).map((program) => (\n            <TunesByProgram key={program.week} program={program} />\n          ))}\n        </div>\n      </Section>\n      <SectionDivider />\n      <AdInArticle />\n      <SectionDivider />\n      <Section>\n        <ArtistItemContainer title=\"同じ回で登場したアーティスト\" artists={data.artist?.relatedArtists} />\n      </Section>\n      <SectionDivider />\n      <Section>\n        <PageNavigation variant=\"artist\" pageContext={pageContext} />\n      </Section>\n    </div>,\n    next ? <TonarinoTab key={next.name} item={next} /> : null,\n  ].filter((element): element is JSX.Element => Boolean(element));\n\n  return (\n    <Layout title={data.artist?.name} drawerContents={<DrawerNavigation pageContext={pageContext} variant=\"artist\" />}>\n      <BindKeyboardSwipeableViews index={1} onChangeIndex={handleChangeIndex} resistance>\n        {tabs}\n      </BindKeyboardSwipeableViews>\n      <SectionDivider />\n      <Section>\n        <NavigationBox />\n      </Section>\n    </Layout>\n  );\n\n  interface TonarinoTabProps {\n    item?: Pick<SitePageContextNext | SitePageContextPrevious, 'name' | 'image' | 'programCount' | 'tunesCount'> | null;\n  }\n\n  function TonarinoTab({ item }: TonarinoTabProps) {\n    return (\n      <div>\n        <ArtistPageHeader artist={item} />\n        <SectionDivider />\n        <Section>\n          <TunesByProgramSkeleton />\n        </Section>\n      </div>\n    );\n  }\n\n  /*\n  const allArtists = useAllArtists();\n  const artists = React.useMemo(() => sortArtists(allArtists), [allArtists]);\n  const { previous, next, index, fieldValue } = pageContext;\n  const programs = data.allProgram.group.map(({ edges }) => edges[0]);\n  const [loading, setLoading] = React.useState(false);\n  const [tab, setTab] = React.useState(index);\n  const _onChangeIndex = (i: number) => {\n    setTab(i);\n  };\n  React.useEffect(() => {\n    const timer = setTimeout(() => {\n      if (tab !== index) {\n        setLoading(true);\n        navigate(`/artist/${artists[tab].fieldValue}`);\n      }\n    }, 500);\n    return () => {\n      clearTimeout(timer);\n    };\n  }, [tab, artists, index]);\n\n  function slideRenderer({ index, key }: SlideRenderProps) {\n    const item = artists[index];\n    return (\n      <div key={key}>\n        <Jumbotron title={item.fieldValue} subtitle={`登場回: ${item.edges.length} 曲数: ${item.tunes.length}`} imgUrl={item.img} />\n        <Container maxWidth=\"md\">\n          <Box pt={4}>\n            {item.fieldValue === fieldValue ? (\n              <div>\n                <LazyViewer programs={programs.map(({ node }) => node)} filter={(tune) => tune.artist === fieldValue} />\n                <ContentBasis>\n                  <PageNavigation {...createNavigationProps(previous, next, '/artist')} />\n                </ContentBasis>\n                {item.fieldValue !== 'スピッツ' ? (\n                  <ContentBasis>\n                    <Typography variant=\"h6\" component=\"h3\" gutterBottom>\n                      {item.fieldValue}と同じ回で登場したアーティスト\n                    </Typography>\n                    <RelatedArtists edges={programs} />\n                  </ContentBasis>\n                ) : null}\n                <ContentBasis>\n                  <NavigationBox />\n                </ContentBasis>\n              </div>\n            ) : (\n              <div>\n                <Box py={2}>\n                  <Typography variant=\"subtitle2\">\n                    <Skeleton variant=\"text\" width={100} />\n                  </Typography>\n                  <Typography variant=\"h6\">\n                    <Skeleton variant=\"text\" />\n                  </Typography>\n                  <TuneCardSkeleton />\n                </Box>\n              </div>\n            )}\n          </Box>\n        </Container>\n      </div>\n    );\n  }\n\n  return (\n    <Layout\n      title={fieldValue}\n      disableGutters\n      disablePaddingTop\n      loading={loading}\n      maxWidth={false}\n      componentViewports={{ BottomNav: false }}\n      drawerContents={<DrawerNavigation {...createNavigationProps(previous, next, '/artist')} />}\n    >\n      <VirtualizedSwipeableViews\n        index={tab}\n        onChangeIndex={_onChangeIndex}\n        slideRenderer={slideRenderer}\n        slideCount={artists.length}\n        resistance\n      />\n    </Layout>\n  );\n  */\n}\n\nexport default ArtistTemplate;\n\nexport const query = graphql`\n  query ArtistTemplate($name: String!) {\n    artist(name: { eq: $name }) {\n      tunesCount\n      programCount\n      image\n      kana\n      name\n      nation\n      program {\n        id\n        date(formatString: \"YYYY-MM-DD\")\n        week\n        title\n        subtitle\n        fields {\n          slug\n        }\n      }\n      tunes {\n        corner\n        id\n        indexInWeek\n        artist {\n          name\n        }\n        kana\n        label\n        nation\n        selector\n        title\n        week\n        year\n        youtube\n      }\n      relatedArtists {\n        name\n        image\n        tunesCount\n        programCount\n      }\n    }\n  }\n`;\n"],"sourceRoot":""}