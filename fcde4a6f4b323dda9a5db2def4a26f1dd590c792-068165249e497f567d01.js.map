{"version":3,"sources":["webpack:///./src/utils/graphql-hooks/useAllSelectors.tsx"],"names":["useAllSelectors","data","React","allProgram","group","filter","fieldValue","map","edges","reduce","accum","curr","d","node","id","indexOf","removeMultiple","playlist","tune","selector","sort","a","b","length"],"mappings":"69BAUO,SAASA,IACd,IAAMC,EAAO,OAgCb,OAAOC,WAAc,WACnB,OAAOD,EAAKE,WAAWC,MACpBC,QAAO,SAACD,GAAD,MAAgC,WAArBA,EAAME,cACxBC,KAAI,SAACH,GACJ,IAAMI,EAsBd,SAAwBA,GACtB,OAAOA,EAAMC,QAAO,SAACC,EAAOC,GAC1B,OAAID,EAAMH,KAAI,SAACK,GAAD,OAAOA,EAAEC,KAAKC,MAAIC,QAAQJ,EAAKE,KAAKC,KAAO,EAAUJ,EACnE,YAAWA,GAAX,CAAkBC,MACjB,IA1BiBK,CAAeZ,EAAMI,OACnC,MAAO,CACLF,WAAYF,EAAME,YAAc,WAChCE,QACAS,SAAUT,EAAMC,QACd,SAACC,EAAOC,GAAR,OACEA,EAAKE,KAAKI,SAAV,YAAyBP,GAAzB,EAAmCC,EAAKE,KAAKI,SAASZ,QAAO,SAACa,GAAD,OAAUA,EAAKC,WAAaf,EAAME,gBAA/F,EAAkHI,KACpH,QAILU,MAAK,SAACC,EAAGC,GAAJ,OAAUA,EAAEL,SAASM,OAASF,EAAEJ,SAASM,QAAUD,EAAEd,MAAMe,OAASF,EAAEb,MAAMe,YACnF,M","file":"fcde4a6f4b323dda9a5db2def4a26f1dd590c792-068165249e497f567d01.js","sourcesContent":["import * as React from 'react';\nimport { useStaticQuery, graphql } from 'gatsby';\nimport { AllSelectorsQuery, Program, ProgramPlaylist } from '../../../graphql-types';\n\nexport interface CategoryItem {\n  fieldValue: string;\n  edges: Edge[];\n  playlist: Playlist[];\n}\n\nexport function useAllSelectors(): CategoryItem[] {\n  const data = useStaticQuery<AllSelectorsQuery>(graphql`\n    query AllSelectors {\n      allProgram {\n        group(field: playlist___selector) {\n          fieldValue\n          edges {\n            node {\n              id\n              week\n              date(formatString: \"YYYY-MM-DD\")\n              title\n              fields {\n                slug\n              }\n              playlist {\n                id\n                indexInWeek\n                title\n                artist\n                year\n                nation\n                selector\n                youtube\n                corner\n              }\n            }\n          }\n        }\n      }\n    }\n  `);\n\n  return React.useMemo(() => {\n    return data.allProgram.group\n      .filter((group) => group.fieldValue !== '草野マサムネ')\n      .map((group) => {\n        const edges = removeMultiple(group.edges);\n        return {\n          fieldValue: group.fieldValue || 'selector',\n          edges,\n          playlist: edges.reduce<Playlist[]>(\n            (accum, curr) =>\n              curr.node.playlist ? [...accum, ...curr.node.playlist.filter((tune) => tune.selector === group.fieldValue)] : [...accum],\n            []\n          ),\n        };\n      })\n      .sort((a, b) => b.playlist.length - a.playlist.length || b.edges.length - a.edges.length);\n  }, []);\n}\n\ntype Edge = {\n  node: Pick<Program, 'id' | 'week' | 'date' | 'title' | 'fields'> & {\n    playlist?: Playlist[];\n  };\n};\ntype Playlist = Pick<ProgramPlaylist, 'id' | 'title' | 'artist' | 'year' | 'selector' | 'youtube'>[];\n\nfunction removeMultiple(edges: Edge[]): Edge[] {\n  return edges.reduce((accum, curr) => {\n    if (accum.map((d) => d.node.id).indexOf(curr.node.id) >= 0) return accum;\n    return [...accum, curr];\n  }, []);\n}\n"],"sourceRoot":""}