{"version":3,"sources":["webpack:///./src/utils/useSorter.tsx","webpack:///./src/templates/artist.tsx"],"names":["useSorter","sort","useAppState","React","value","useSortProgram","sorter","a","b","week","useSortProgramNode","node","BindKeyboardSwipeableViews","bindKeyboard","SwipeableViews","ArtistTemplate","data","pageContext","artist","nonNullable","previous","next","sortProgram","initialIndex","programs","program","map","playlist","tunes","filter","tune","tabs","key","name","item","title","artists","relatedArtists","variant","element","Boolean","drawerContents","index","onChangeIndex","navigate","slug","resistance"],"mappings":"4FAAA,kIAQe,SAASA,IAAuC,IACrDC,EAASC,cAATD,KACR,OAAOE,eAAkB,SAACC,GAAD,MAA6B,UAATH,EAAmBG,GAASA,IAAQ,CAACH,IAG7E,SAASI,IACd,IAAMC,EAASN,IACf,OAAO,SAACO,EAAiCC,GAAlC,eAAsEF,GAAO,UAACC,aAAD,EAACA,EAAGE,YAAJ,QAAY,IAAZ,UAAkBD,aAAlB,EAAkBA,EAAGC,YAArB,QAA6B,KAG5G,SAASC,IACd,IAAMJ,EAASN,IACf,OAAO,SAACO,EAA2CC,GAA5C,mBACLF,GAAO,UAACC,SAAD,UAACA,EAAGI,YAAJ,aAAC,EAASF,YAAV,QAAkB,IAAlB,UAAwBD,SAAxB,UAAwBA,EAAGG,YAA3B,aAAwB,EAASF,YAAjC,QAAyC,O,kCCrBpD,oNAkBMG,EAA6BC,uBAAaC,KAgEjCC,UAzDf,YAAmE,MAAzCC,EAAyC,EAAzCA,KAAMC,EAAmC,EAAnCA,YACxBC,EAASC,YAAYH,EAAKE,QACxBE,EAAmBH,EAAnBG,SAAUC,EAASJ,EAATI,KACZC,EAAcjB,cACdkB,EAAeH,EAAW,EAAI,EAU9BI,EAAQ,UAAGN,EAAOO,eAAV,aAAG,EAAgBC,KAAI,SAACD,GAAD,8BAChCA,EADgC,CAEnCE,SAAQ,UAAET,EAAOU,aAAT,aAAE,EAAcC,QAAO,SAACC,GAAD,OAAUA,aAAA,EAAAA,EAAMrB,SAASgB,aAAf,EAAeA,EAAShB,cAE7DsB,EAAO,CACXX,EAAW,gBAAC,IAAD,CAAmBY,IAAKZ,aAAF,EAAEA,EAAUa,KAAMC,KAAMd,IAAe,KACxE,uBAAKY,IAAI,QACP,gBAAC,IAAD,CAAkBd,OAAQA,IAC1B,gBAAC,IAAD,MACA,gBAAC,IAAD,KACE,2BACGM,aADH,EACGA,EAAUvB,KAAKqB,GAAaI,KAAI,SAACD,GAAD,OAC/B,gBAAC,IAAD,CAAgBO,IAAKP,EAAQhB,KAAMgB,QAASA,SAIlD,gBAAC,IAAD,MACA,gBAAC,IAAD,MACA,gBAAC,IAAD,MACA,gBAAC,IAAD,KACE,gBAAC,IAAD,CAAqBU,MAAM,iBAAiBC,QAASjB,YAAYD,EAAOmB,mBAE1E,gBAAC,IAAD,MACA,gBAAC,IAAD,KACE,gBAAC,IAAD,CAAgBC,QAAQ,SAASrB,YAAaA,MAGlDI,EAAO,gBAAC,IAAD,CAAmBW,IAAKX,EAAKY,KAAMC,KAAMb,IAAW,MAC3DQ,QAAO,SAACU,GAAD,OAAqCC,QAAQD,MAEtD,OACE,gBAAC,IAAD,CAAQJ,MAAOjB,EAAOe,KAAMQ,eAAgB,gBAAC,IAAD,CAAkBxB,YAAaA,EAAaqB,QAAQ,YAC9F,gBAAC1B,EAAD,CAA4B8B,MAAOnB,EAAcoB,cAzC3B,SAACD,GACzB,GAAIA,IAAUnB,EAAd,CACwC,MAGI,EAH5C,GAAIF,GAAQqB,IAAUnB,EAAe,EACnCqB,mBAAQ,UAACvB,EAAKwB,YAAN,QAAc,KAExB,GAAIzB,GAAYsB,IAAUnB,EAAe,EACvCqB,mBAAQ,UAACxB,EAASyB,YAAV,QAAkB,OAmCyDC,YAAU,GAC1Ff,GAEH,gBAAC,IAAD,MACA,gBAAC,IAAD,KACE,gBAAC,IAAD","file":"component---src-templates-artist-tsx-03149129c38af393e8c8.js","sourcesContent":["import * as React from 'react';\nimport { useAppState } from '../gatsby-theme-aoi-top-layout/utils/AppStateContext';\nimport { Maybe, Program, ProgramPlaylist } from '../../graphql-types';\n\n/** usage\n * const sorter = useSorter();\n * programs.sort((a, b) => sorter(a.week - b.week))\n */\nexport default function useSorter(): (value: number) => number {\n  const { sort } = useAppState();\n  return React.useCallback((value: number) => (sort === 'older' ? value : -value), [sort]);\n}\n\nexport function useSortProgram(): (a: Maybe<Pick<Program, 'week'>>, b: Maybe<Pick<Program, 'week'>>) => number {\n  const sorter = useSorter();\n  return (a: Maybe<Pick<Program, 'week'>>, b: Maybe<Pick<Program, 'week'>>) => sorter((a?.week ?? 0) - (b?.week ?? 0));\n}\n\nexport function useSortProgramNode(): (a: { node: Maybe<Pick<Program, 'week'>> }, b: { node: Maybe<Pick<Program, 'week'>> }) => number {\n  const sorter = useSorter();\n  return (a: { node: Maybe<Pick<Program, 'week'>> }, b: { node: Maybe<Pick<Program, 'week'>> }) =>\n    sorter((a?.node?.week ?? 0) - (b?.node?.week ?? 0));\n}\n\nexport function useSortPlaylist(): (\n  a: Maybe<Pick<ProgramPlaylist, 'week' | 'indexInWeek'>> | undefined,\n  b: Maybe<Pick<ProgramPlaylist, 'week' | 'indexInWeek'>> | undefined\n) => number {\n  const sorter = useSorter();\n  return (\n    a: Maybe<Pick<ProgramPlaylist, 'week' | 'indexInWeek'>> | undefined,\n    b: Maybe<Pick<ProgramPlaylist, 'week' | 'indexInWeek'>> | undefined\n  ) => sorter((a?.week ?? 0) - (b?.week ?? 0) || (a?.indexInWeek ?? 0) - (b?.indexInWeek ?? 0));\n}\n","import * as React from 'react';\nimport { graphql, navigate } from 'gatsby';\nimport SwipeableViews from 'react-swipeable-views';\nimport { bindKeyboard } from 'react-swipeable-views-utils';\nimport Layout from '../layout';\nimport Section, { SectionDivider } from '../components/Section';\nimport { ArtistPageHeader } from '../components/PageHeader';\nimport TunesByProgram from '../components/TunesByProgram';\nimport ArtistItemContainer from '../components/ArtistItemContainer';\nimport PageNavigation from '../components/PageNavigation';\nimport DrawerNavigation from '../components/DrawerNavigation';\nimport NavigationBox from '../components/NavigationBox';\nimport { AdBasic } from '../components/Ads';\nimport { ArtistTonarinoTab } from '../components/TonarinoTab';\nimport { useSortProgram } from '../utils/useSorter';\nimport nonNullable from '../utils/nonNullable';\nimport { ArtistTemplateQuery, SitePageContext } from '../../graphql-types';\n\nconst BindKeyboardSwipeableViews = bindKeyboard(SwipeableViews);\n\ninterface Props {\n  data: ArtistTemplateQuery;\n  pageContext: SitePageContext;\n}\n\nfunction ArtistTemplate({ data, pageContext }: Props): JSX.Element {\n  const artist = nonNullable(data.artist);\n  const { previous, next } = pageContext;\n  const sortProgram = useSortProgram();\n  const initialIndex = previous ? 1 : 0;\n  const handleChangeIndex = (index: number) => {\n    if (index === initialIndex) return;\n    if (next && index === initialIndex + 1) {\n      navigate(next.slug ?? '#');\n    }\n    if (previous && index === initialIndex - 1) {\n      navigate(previous.slug ?? '#');\n    }\n  };\n  const programs = artist.program?.map((program) => ({\n    ...program,\n    playlist: artist.tunes?.filter((tune) => tune?.week === program?.week),\n  }));\n  const tabs = [\n    previous ? <ArtistTonarinoTab key={previous?.name} item={previous} /> : null,\n    <div key=\"main\">\n      <ArtistPageHeader artist={artist} />\n      <SectionDivider />\n      <Section>\n        <div>\n          {programs?.sort(sortProgram).map((program) => (\n            <TunesByProgram key={program.week} program={program} />\n          ))}\n        </div>\n      </Section>\n      <SectionDivider />\n      <AdBasic />\n      <SectionDivider />\n      <Section>\n        <ArtistItemContainer title=\"同じ回で登場したアーティスト\" artists={nonNullable(artist.relatedArtists)} />\n      </Section>\n      <SectionDivider />\n      <Section>\n        <PageNavigation variant=\"artist\" pageContext={pageContext} />\n      </Section>\n    </div>,\n    next ? <ArtistTonarinoTab key={next.name} item={next} /> : null,\n  ].filter((element): element is JSX.Element => Boolean(element));\n\n  return (\n    <Layout title={artist.name} drawerContents={<DrawerNavigation pageContext={pageContext} variant=\"artist\" />}>\n      <BindKeyboardSwipeableViews index={initialIndex} onChangeIndex={handleChangeIndex} resistance>\n        {tabs}\n      </BindKeyboardSwipeableViews>\n      <SectionDivider />\n      <Section>\n        <NavigationBox />\n      </Section>\n    </Layout>\n  );\n}\n\nexport default ArtistTemplate;\n\nexport const query = graphql`\n  query ArtistTemplate($name: String!) {\n    artist(name: { eq: $name }) {\n      tunesCount\n      programCount\n      image\n      kana\n      name\n      nation\n      program {\n        id\n        date(formatString: \"YYYY-MM-DD\")\n        week\n        title\n        subtitle\n        fields {\n          slug\n        }\n      }\n      tunes {\n        corner\n        id\n        indexInWeek\n        artist {\n          name\n          slug\n        }\n        kana\n        label\n        nation\n        selector\n        title\n        week\n        year\n        youtube\n      }\n      relatedArtists {\n        name\n        image\n        tunesCount\n        programCount\n        slug\n      }\n    }\n  }\n`;\n"],"sourceRoot":""}